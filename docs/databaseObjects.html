<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from src/site/markdown/docs/databaseObjects.md at 06 Jul 2025
 | Rendered using Apache Maven Fluido Skin 2.1.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <title>Database Object Representation â€“ MyBatis Dynamic SQL</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-2.1.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-2.1.0.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1><a href="../docs/introduction.html">MyBatis Dynamic SQL</a></h1></div></div>
          <div class="pull-right"><div id="bannerRight"><h1><a href="http://www.mybatis.org/"><img src="https://mybatis.org/images/mybatis-logo.png" alt="MyBatis logo" /> MyBatis</a></h1></div></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 03 Jun 2024<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.0.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">User&apos;s Guide</li>
    <li><a href="../docs/introduction.html">Introduction</a></li>
    <li><a href="../docs/CHANGELOG.html">Change Log</a></li>
    <li><a href="../docs/migratingV1toV2.html">Migrating from V1 to V2</a></li>
    <li><a href="../docs/quickStart.html">Quick Start</a></li>
    <li><a href="../docs/exceptions.html">Exceptions thrown by the Library</a></li>
    <li><a href="../docs/configuration.html">Configuration of the Library</a></li>
    <li class="active"><a>Modeling Database Objects</a></li>
    <li><a href="../docs/whereClauses.html"><span class="icon-chevron-down"></span>WHERE Clause Support</a>
     <ul class="nav nav-list">
      <li><a href="../docs/conditions.html">WHERE Conditions</a></li>
     </ul></li>
    <li><a href="../docs/select.html"><span class="icon-chevron-down"></span>SELECT Statements</a>
     <ul class="nav nav-list">
      <li><a href="../docs/caseExpressions.html">Case Expressions</a></li>
      <li><a href="../docs/complexQueries.html">Complex Queries</a></li>
     </ul></li>
    <li><a href="../docs/delete.html">DELETE Statements</a></li>
    <li><a href="../docs/insert.html">INSERT Statements</a></li>
    <li><a href="../docs/update.html">UPDATE Statements</a></li>
    <li><a href="../docs/subQueries.html">SubQuery Support</a></li>
    <li><a href="../docs/functions.html">Database Functions</a></li>
    <li><a href="../docs/mybatis3.html">MyBatis3 Support</a></li>
    <li><a href="../docs/spring.html">Spring Support</a></li>
    <li><a href="../docs/springBatch.html">Spring Batch Support</a></li>
    <li><a href="../docs/kotlinOverview.html"><span class="icon-chevron-right"></span>Kotlin Support</a></li>
    <li><a href="../docs/howItWorks.html">How it Works</a></li>
    <li><a href="../docs/extending.html">Extending the Library</a></li>
    <li><a href="../docs/codingStandards.html">Coding Standards</a></li>
    <li><a href="../docs/motivation.html">Motivation</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section><a id="Database_Object_Representation"></a>
<h1>Database Object Representation</h1>
<p>MyBatis Dynamic SQL works with Java objects that represent relational tables or views.</p><section><a id="Table_or_View_Representation"></a>
<h2>Table or View Representation</h2>
<p>The class <code>org.mybatis.dynamic.sql.SqlTable</code> is used to represent a table or view in a database. An <code>SqlTable</code> holds a
name, and a collection of <code>SqlColumn</code> objects that represent the columns in a table or view. A subclass of <code>SqlTable</code> -
<code>AliasableSqlTable</code> should be used in cases where you want to specify a table alias that should be used in all cases,
or if you need to change the table name at runtime.</p>
<p>A table or view name in SQL has three parts:</p>
<ol style="list-style-type: decimal;">

<li>The catalog - which is optional and is rarely used outside of Microsoft SQL Server. If unspecified the default
catalog will be used - and many databases only have one catalog</li>
<li>The schema - which is optional but is very often specified. If unspecified, the default schema will be used</li>
<li>The table name - which is required</li>
</ol>
<p>Typical examples of names are as follows:</p>
<ul>

<li><code>&quot;dbo..bar&quot;</code> - a name with a catalog (dbo) and a table name (bar). This is typical for SQL Server</li>
<li><code>&quot;foo.bar&quot;</code> - a name with a schema (foo) and a table name (bar). This is typical in many databases when you want to
access tables that are not in the default schema</li>
<li><code>&quot;bar&quot;</code> - a name with just a table name (bar). This will access a table or view in the default catalog and schema for
a connection</li>
</ul>
<p>In MyBatis Dynamic SQL, the full name of the table should be supplied on the constructor of the table object.
If a table name needs to change at runtime (say for sharding support), then use the <code>withName</code> method on
<code>AliasableSqlTable</code> to create an instance with the new name.</p>
<p>We recommend using the base class <code>AliasableSqlTable</code> in all cases as it provides the most flexibility. The
<code>SqlTable</code> class remains in the library for compatibility with older code only.</p>
<p>For example:</p>

<pre class="prettyprint"><code class="language-java">import org.mybatis.dynamic.sql.AliasableSqlTable;

public class MyTable extends AliasableSqlTable&lt;MyTable&gt; {
    public MyTable() {
        super(&quot;MyTable&quot;, MyTable::new);
    }
}
</code></pre>
<p>Or</p>

<pre class="prettyprint"><code class="language-java">public class MyTable extends AliasableSqlTable&lt;MyTable&gt; {
    public MyTable() {
        super(&quot;MySchema.MyTable&quot;, MyTable::new);
    }
}
</code></pre>
<p>You can change a table name:</p>

<pre class="prettyprint"><code class="language-java">public class MyTable extends AliasableSqlTable&lt;MyTable&gt; {
    public MyTable() {
        super(&quot;Schema1.MyTable&quot;, MyTable::new);
    }
}

MyTable schema1Table = new MyTable();
MyTable schema2Table = schema1Table.withName(&quot;Schema2.MyTable&quot;);
</code></pre></section><section><a id="Aliased_Tables"></a>
<h2>Aliased Tables</h2>
<p>In join queries, it is usually a good practice to specify table aliases. The <code>select</code> statement includes
support for specifying table aliases in each query in a way that looks like natural SQL. For example:</p>

<pre class="prettyprint"><code class="language-java">    SelectStatementProvider selectStatement = select(orderMaster.orderId, orderDate, orderLine.lineNumber, itemMaster.description, orderLine.quantity)
            .from(orderMaster, &quot;om&quot;)
            .join(orderLine, &quot;ol&quot;).on(orderMaster.orderId, equalTo(orderLine.orderId))
            .join(itemMaster, &quot;im&quot;).on(orderLine.itemId, equalTo(itemMaster.itemId))
            .where(orderMaster.orderId, isEqualTo(2))
            .build()
            .render(RenderingStrategies.MYBATIS3);
</code></pre>
<p>In a query like this, the library will automatically append the table alias to the column name when the query is rendered.
Internally, the alias for a column is determined by looking up the associated table in a HashMap maintained within the
query model. If you do not specify a table alias, the library will automatically append the table name in join queries.</p>
<p>Unfortunately, this strategy fails for self-joins. It can also get confusing when there are sub-queries. Imagine a
query like this:</p>

<pre class="prettyprint"><code class="language-java">    SelectStatementProvider selectStatement = select(user.userId, user.userName, user.parentId)
            .from(user, &quot;u1&quot;)
            .join(user, &quot;u2&quot;).on(user.userId, equalTo(user.parentId))
            .where(user.userId, isEqualTo(4))
            .build()
            .render(RenderingStrategies.MYBATIS3);
</code></pre>
<p>In this query it is not clear which instance of the <code>user</code> table is used for each column, and there will only be entry in the
HashMap for the <code>user</code> table - so only one of the aliases specified in the select statement will be in effect.
There are two ways to deal with this problem.</p>
<p>The first is to simply create another instance of the User <code>SqlTable</code> object. With this method it is very clear which column
belongs to which instance of the table and the library can easily calculate aliases:</p>

<pre class="prettyprint"><code class="language-java">    User user1 = new User();
    User user2 = new User();
    SelectStatementProvider selectStatement = select(user1.userId, user1.userName, user1.parentId)
            .from(user1, &quot;u1&quot;)
            .join(user2, &quot;u2&quot;).on(user1.userId, equalTo(user2.parentId))
            .where(user2.userId, isEqualTo(4))
            .build()
            .render(RenderingStrategies.MYBATIS3);
</code></pre>
<p>Starting with version 1.3.1, there is new method where the alias can be specified in the table object itself. This allows
you to move the aliases out of the <code>select</code> statement.</p>

<pre class="prettyprint"><code class="language-java">    User user1 = user.withAlias(&quot;u1&quot;);
    User user2 = user.withAlias(&quot;u2&quot;);

    SelectStatementProvider selectStatement = select(user1.userId, user1.userName, user1.parentId)
            .from(user1)
            .join(user2).on(user1.userId, equalTo(user2.parentId))
            .where(user2.userId, isEqualTo(4))
            .build()
            .render(RenderingStrategies.MYBATIS3);
</code></pre>
<p>To enable this support, your table objects should extend <code>org.mybatis.dynamic.sql.AliasableSqlTable</code> rather than
<code>org.mybatis.dynamic.sql.SqlTable</code> as follows:</p>

<pre class="prettyprint"><code class="language-java">    public static final class User extends AliasableSqlTable&lt;User&gt; {
        public final SqlColumn&lt;Integer&gt; userId = column(&quot;user_id&quot;, JDBCType.INTEGER);
        public final SqlColumn&lt;String&gt; userName = column(&quot;user_name&quot;, JDBCType.VARCHAR);
        public final SqlColumn&lt;Integer&gt; parentId = column(&quot;parent_id&quot;, JDBCType.INTEGER);

        public User() {
            super(&quot;User&quot;, User::new);
        }
    }
</code></pre>
<p>If you use an aliased table object, and also specify an alias in the <code>select</code> statement, the alias from the <code>select</code>
statement will override the alias in the table object.</p></section><section><a id="Column_Representation"></a>
<h2>Column Representation</h2>
<p>The class <code>org.mybatis.dynamic.sql.SqlColumn</code> is used to represent a column in a table or view. An <code>SqlColumn</code> is always
associated with a <code>SqlTable</code>. In its most basic form, the <code>SqlColumn</code> class holds a name and a reference to the
<code>SqlTable</code> it is associated with. The table reference is required so that table aliases can be applied to columns in the
rendering phase.</p>
<p>The <code>SqlColumn</code> will be rendered in SQL based on the <code>RenderingStrategy</code> applied to the SQL statement. Typically the
rendering strategy generates a string that represents a parameter marker in whatever SQL engine you are using. For
example, MyBatis3 parameter markers are formatted as &#x201c;#{some_attribute}&#x201d;. By default, all columns are rendered with the
same strategy. The library supplies rendering strategies that are appropriate for several SQL execution engines
including MyBatis3 and Spring JDBC template.</p>
<p>In some cases it is necessary to override the rendering strategy for a particular column - so the <code>SqlColumn</code> class
supports specifying a rendering strategy for a column that will override the rendering strategy applied to a statement.
A good example of this use case is with PostgreSQL. In that database it is required to add the string &#x201c;::jsonb&#x201d; to a
prepared statement parameter marker when inserting or updating JSON fields, but not for other fields. A column based
rendering strategy enables this.</p>
<p>The <code>SqlColumn</code> class has additional optional attributes that are useful for SQL rendering - especially in MyBatis3.
These include:</p>
<ul>

<li>The <code>java.sql.JDBCType</code> of the column. This will be rendered into the MyBatis3 compatible parameter marker - which
helps with picking type handlers and also inserting or updating null capable fields</li>
<li>A String containing a type handler - either a type handler alias or the fully qualified type of a type handler. This
will be rendered into the MyBatis3 compatible parameter marker</li>
</ul>
<p>If you are not using MyBatis3, then you do not need to specify the JDBC Type or type handler as those attributes are
ignored by other rendering strategies.</p>
<p>Finally, the <code>SqlColumn</code> class has methods to designate a column alias or sort order for use in different SQL
statements.</p>
<p>We recommend a usage pattern for creating table and column objects that provides quite a bit of flexibility for usage.
See the <a href="quickStart.html">Quick Start</a> page for a complete example.</p></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Â©      2016â€“2025
<a href="https://www.mybatis.org/">MyBatis.org</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
