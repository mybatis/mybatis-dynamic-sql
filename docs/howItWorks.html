<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/docs/howItWorks.md at 07 October 2022
 | Rendered using Apache Maven Fluido Skin 1.11.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>MyBatis Dynamic SQL &#x2013; How it Works</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.11.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.11.1.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="../docs/introduction.html" id="bannerLeft"><h1>MyBatis Dynamic SQL</h1>
</a></div>
          <div class="pull-right"><a href="http://www.mybatis.org/" id="bannerRight" title="MyBatis logo"><img src="https://mybatis.org/images/mybatis-logo.png"  alt="MyBatis logo" style="" /></a></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 07 October 2022<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.4.1</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">User's Guide</li>
    <li><a href="../docs/introduction.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="../docs/CHANGELOG.html" title="Change Log"><span class="none"></span>Change Log</a></li>
    <li><a href="../docs/quickStart.html" title="Quick Start"><span class="none"></span>Quick Start</a></li>
    <li><a href="../docs/exceptions.html" title="Exceptions thrown by the Library"><span class="none"></span>Exceptions thrown by the Library</a></li>
    <li><a href="../docs/configuration.html" title="Configuration of the Library"><span class="none"></span>Configuration of the Library</a></li>
    <li><a href="../docs/databaseObjects.html" title="Modeling Database Objects"><span class="none"></span>Modeling Database Objects</a></li>
    <li><a href="../docs/whereClauses.html" title="WHERE Clause Support"><span class="icon-chevron-down"></span>WHERE Clause Support</a>
     <ul class="nav nav-list">
      <li><a href="../docs/conditions.html" title="WHERE Conditions"><span class="none"></span>WHERE Conditions</a></li>
     </ul></li>
    <li><a href="../docs/select.html" title="SELECT Statements"><span class="icon-chevron-down"></span>SELECT Statements</a>
     <ul class="nav nav-list">
      <li><a href="../docs/complexQueries.html" title="Complex Queries"><span class="none"></span>Complex Queries</a></li>
     </ul></li>
    <li><a href="../docs/delete.html" title="DELETE Statements"><span class="none"></span>DELETE Statements</a></li>
    <li><a href="../docs/insert.html" title="INSERT Statements"><span class="none"></span>INSERT Statements</a></li>
    <li><a href="../docs/update.html" title="UPDATE Statements"><span class="none"></span>UPDATE Statements</a></li>
    <li><a href="../docs/subQueries.html" title="SubQuery Support"><span class="none"></span>SubQuery Support</a></li>
    <li><a href="../docs/functions.html" title="Database Functions"><span class="none"></span>Database Functions</a></li>
    <li><a href="../docs/mybatis3.html" title="MyBatis3 Support"><span class="none"></span>MyBatis3 Support</a></li>
    <li><a href="../docs/spring.html" title="Spring Support"><span class="none"></span>Spring Support</a></li>
    <li><a href="../docs/springBatch.html" title="Spring Batch Support"><span class="none"></span>Spring Batch Support</a></li>
    <li><a href="../docs/kotlinOverview.html" title="Kotlin Support"><span class="icon-chevron-right"></span>Kotlin Support</a></li>
    <li class="active"><a><span class="none"></span>How it Works</a></li>
    <li><a href="../docs/extending.html" title="Extending the Library"><span class="none"></span>Extending the Library</a></li>
    <li><a href="../docs/codingStandards.html" title="Coding Standards"><span class="none"></span>Coding Standards</a></li>
    <li><a href="../docs/motivation.html" title="Motivation"><span class="none"></span>Motivation</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>How it Works</h1>
<p>MyBatis does four main things:</p>
<ol style="list-style-type: decimal">

<li>It executes SQL safely and abstracts away all the intricacies of JDBC</li>
<li>It maps parameter objects to JDBC prepared statement parameters</li>
<li>It maps rows in JDBC result sets to objects</li>
<li>It can generate dynamic SQL with special tags in XML, or through the use of various templating engines</li>
</ol>
<p>This library takes full advantage of the first three capabilities in MyBatis and essentially becomes another
templating engine for generating dynamic SQL.</p>
<p>For example, MyBatis can execute an SQL string formatted like this:</p>

<div class="source"><pre class="prettyprint"><code class="language-sql">  select id, description from table_codes where id = #{id,jdbcType=INTEGER} 
</code></pre></div>
<p>This is standard SQL with a MyBatis twist - the parameter notation <code>#{id,jdbcType=INTEGER}</code>
tells MyBatis to take the <code>id</code> property of a parameter object and use it as a JDBC prepared statement
parameter.</p>
<p>Now suppose we have two Java classes like this:</p>

<div class="source"><pre class="prettyprint"><code class="language-java">public class TableCode {
  private Integer id;
  private String description;
  ... getters/setters
}

public class Parameter {
  private String sql = &quot;select id, description from table_codes where id = #{id,jdbcType=INTEGER}&quot;;
  private Integer id;

  public Parameter(Integer id) {
    this.id = id;
  }
  
  public Integer getId() {
    return id;
  }
  
  public String getSql() {
    return sql;
  }
}
</code></pre></div>
<p>These classes can be used in conjunction with a MyBatis mapper like this:</p>

<div class="source"><pre class="prettyprint"><code class="language-java">public interface Mapper {

  @Select({
    &quot;${sql}&quot;
  })
  TableCode getTableCode(Parameter parameter);
}
</code></pre></div>
<p>Using this mapper with MyBatis looks like this:</p>

<div class="source"><pre class="prettyprint"><code class="language-java">  try(SqlSession sqlSession = sqlSessionFactory.openSession()) {
    Mapper mapper = sqlSession.getMapper(Mapper.class);
    Parameter parameter = new Parameter(2);
    TableCode tableCode = mapper.getTableCode(parameter);
    assertThat(tableCode.getId()).isEqualTo(2);
  }
</code></pre></div>
<p>The parameter object has a property called <code>sql</code>. That SQL string will be prepared as a JDBC prepared statement
in MyBatis. The SQL string also references a property called <code>id</code>. That property - from the same parameter object -
will be used as the value of the prepared statement parameter.</p>
<p>So the main idea is this - this library builds a version of the <code>Parameter</code> class shown above. The class includes
the full SQL statement to execute, formatted for MyBatis, and any parameters referenced by the statement.
There are different versions of these classes for the different types of SQL statements. But in every case, the class
is designed to be the one single parameter for a MyBatis mapper method.</p><section>
<h2><a name="What_About_SQL_Injection.3F"></a>What About SQL Injection?</h2>
<p>It is true that mappers written this way are open to SQL injection. This is also true of using any of the
various SQL provider classes in MyBatis (<code>@SelectProvider</code>, etc.) So you must be careful that these types of mappers are not exposed to any general user input.</p>
<p>If you follow these practices, you will lower the risk of SQL injection:</p>
<ol style="list-style-type: decimal">

<li>Always use MyBatis annotated mappers</li>
<li>Use the <code>SqlProviderAdapter</code> utility class in conjunction with the MyBatis provider annotations (<code>@InsertProvider</code>, <code>@SelectProvider</code>, etc.)</li>
</ol></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2016&#x2013;2022
<a href="https://www.mybatis.org/">MyBatis.org</a>
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>
