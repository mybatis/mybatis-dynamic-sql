<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/docs/quickStart.md at 21 April 2023
 | Rendered using Apache Maven Fluido Skin 1.11.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>MyBatis Dynamic SQL &#x2013; MyBatis Dynamic SQL Quick Start</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.11.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.11.1.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="../docs/introduction.html" id="bannerLeft"><h1>MyBatis Dynamic SQL</h1>
</a></div>
          <div class="pull-right"><a href="http://www.mybatis.org/" id="bannerRight" title="MyBatis logo"><img src="https://mybatis.org/images/mybatis-logo.png"  alt="MyBatis logo" style="" /></a></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 21 April 2023<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.5.0</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">User's Guide</li>
    <li><a href="../docs/introduction.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="../docs/CHANGELOG.html" title="Change Log"><span class="none"></span>Change Log</a></li>
    <li class="active"><a><span class="none"></span>Quick Start</a></li>
    <li><a href="../docs/exceptions.html" title="Exceptions thrown by the Library"><span class="none"></span>Exceptions thrown by the Library</a></li>
    <li><a href="../docs/configuration.html" title="Configuration of the Library"><span class="none"></span>Configuration of the Library</a></li>
    <li><a href="../docs/databaseObjects.html" title="Modeling Database Objects"><span class="none"></span>Modeling Database Objects</a></li>
    <li><a href="../docs/whereClauses.html" title="WHERE Clause Support"><span class="icon-chevron-down"></span>WHERE Clause Support</a>
     <ul class="nav nav-list">
      <li><a href="../docs/conditions.html" title="WHERE Conditions"><span class="none"></span>WHERE Conditions</a></li>
     </ul></li>
    <li><a href="../docs/select.html" title="SELECT Statements"><span class="icon-chevron-down"></span>SELECT Statements</a>
     <ul class="nav nav-list">
      <li><a href="../docs/complexQueries.html" title="Complex Queries"><span class="none"></span>Complex Queries</a></li>
     </ul></li>
    <li><a href="../docs/delete.html" title="DELETE Statements"><span class="none"></span>DELETE Statements</a></li>
    <li><a href="../docs/insert.html" title="INSERT Statements"><span class="none"></span>INSERT Statements</a></li>
    <li><a href="../docs/update.html" title="UPDATE Statements"><span class="none"></span>UPDATE Statements</a></li>
    <li><a href="../docs/subQueries.html" title="SubQuery Support"><span class="none"></span>SubQuery Support</a></li>
    <li><a href="../docs/functions.html" title="Database Functions"><span class="none"></span>Database Functions</a></li>
    <li><a href="../docs/mybatis3.html" title="MyBatis3 Support"><span class="none"></span>MyBatis3 Support</a></li>
    <li><a href="../docs/spring.html" title="Spring Support"><span class="none"></span>Spring Support</a></li>
    <li><a href="../docs/springBatch.html" title="Spring Batch Support"><span class="none"></span>Spring Batch Support</a></li>
    <li><a href="../docs/kotlinOverview.html" title="Kotlin Support"><span class="icon-chevron-right"></span>Kotlin Support</a></li>
    <li><a href="../docs/howItWorks.html" title="How it Works"><span class="none"></span>How it Works</a></li>
    <li><a href="../docs/extending.html" title="Extending the Library"><span class="none"></span>Extending the Library</a></li>
    <li><a href="../docs/codingStandards.html" title="Coding Standards"><span class="none"></span>Coding Standards</a></li>
    <li><a href="../docs/motivation.html" title="Motivation"><span class="none"></span>Motivation</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>MyBatis Dynamic SQL Quick Start</h1>
<p>Working with MyBatis Dynamic SQL requires the following steps:</p>
<ol style="list-style-type: decimal">

<li>Create table and column objects</li>
<li>(For MyBatis3) Create mappers (XML or Java Based)</li>
<li>Write and use SQL</li>
</ol>
<p>For the purposes of this discussion, we will show using the library to perform CRUD operations on this table:</p>

<div class="source"><pre class="prettyprint"><code class="language-sql">create table Person (
    id int not null,
    first_name varchar(30) not null,
    last_name varchar(30) not null,
    birth_date date not null,
    employed varchar(3) not null,
    occupation varchar(30) null,
    address_id int not null,
    primary key(id)
);
</code></pre></div>
<p>We will also create a simple Java class to represent a row in the table:</p>

<div class="source"><pre class="prettyprint"><code class="language-java">package examples.simple;

import java.util.Date;

public class PersonRecord {
    private Integer id;
    private String firstName;
    private LastName lastName;
    private Date birthDate;
    private Boolean employed;
    private String occupation;
    private Integer addressId;
    
    // getters and setters omitted
}
</code></pre></div><section>
<h2><a name="Defining_Tables_and_Columns"></a>Defining Tables and Columns</h2>
<p>The class <code>org.mybatis.dynamic.sql.SqlTable</code> is used to define a table. A table definition includes
the actual name of the table (including schema or catalog if appropriate). A table alias can be applied in a
select statement if desired.  Your table should be defined by extending the <code>SqlTable</code> class.</p>
<p>The class <code>org.mybatis.dynamic.sql.SqlColumn</code> is used to define columns for use in the library.
SqlColumns should be created using the builder methods in SqlTable.
A column definition includes:</p>
<ol style="list-style-type: decimal">

<li>The Java type</li>
<li>The actual column name (an alias can be applied in a select statement)</li>
<li>The JDBC type</li>
<li>(optional) The name of a type handler to use in MyBatis if the default type handler is not desired</li>
</ol>
<p>We suggest the following usage pattern to give maximum flexibility.  This pattern will allow you to use your
table and column names in a &#x201c;qualified&#x201d; or &#x201c;un-qualified&#x201d; manner that looks like natural SQL. For example, in the
following a column could be referred to as <code>firstName</code> or <code>person.firstName</code>.</p>

<div class="source"><pre class="prettyprint"><code class="language-java">package examples.simple;

import java.sql.JDBCType;
import java.util.Date;

import org.mybatis.dynamic.sql.SqlColumn;
import org.mybatis.dynamic.sql.SqlTable;

public final class PersonDynamicSqlSupport {
    public static final Person person = new Person();
    public static final SqlColumn&lt;Integer&gt; id = person.id;
    public static final SqlColumn&lt;String&gt; firstName = person.firstName;
    public static final SqlColumn&lt;LastName&gt; lastName = person.lastName;
    public static final SqlColumn&lt;Date&gt; birthDate = person.birthDate;
    public static final SqlColumn&lt;Boolean&gt; employed = person.employed;
    public static final SqlColumn&lt;String&gt; occupation = person.occupation;
    public static final SqlColumn&lt;Integer&gt; addressId = person.addressId;

    public static final class Person extends SqlTable {
        public final SqlColumn&lt;Integer&gt; id = column(&quot;id&quot;, JDBCType.INTEGER);
        public final SqlColumn&lt;String&gt; firstName = column(&quot;first_name&quot;, JDBCType.VARCHAR);
        public final SqlColumn&lt;LastName&gt; lastName = column(&quot;last_name&quot;, JDBCType.VARCHAR, &quot;examples.simple.LastNameTypeHandler&quot;);
        public final SqlColumn&lt;Date&gt; birthDate = column(&quot;birth_date&quot;, JDBCType.DATE);
        public final SqlColumn&lt;Boolean&gt; employed = column(&quot;employed&quot;, JDBCType.VARCHAR, &quot;examples.simple.YesNoTypeHandler&quot;);
        public final SqlColumn&lt;String&gt; occupation = column(&quot;occupation&quot;, JDBCType.VARCHAR);
        public final SqlColumn&lt;Integer&gt; addressId = column(&quot;address_id&quot;, JDBCType.INTEGER);

        public Person() {
            super(&quot;Person&quot;);
        }
    }
}
</code></pre></div></section><section>
<h2><a name="Creating_MyBatis3_Mappers"></a>Creating MyBatis3 Mappers</h2>
<p>The library will create classes that will be used as input to a MyBatis mapper.  These classes include the generated
SQL, as well as a parameter set that will match the generated SQL.  Both are required by MyBatis.  It is intended that
these objects be the one and only parameter to a MyBatis mapper method.</p>
<p>The library can be used with both XML and annotated mappers, but we recommend using MyBatis' annotated mapper support in
all cases.  The only case where XML is required is when you code a JOIN statement - in that case you will need to define
your result map in XML due to limitations of the MyBatis annotations in supporting joins.</p>
<p>For example, a mapper might look like this:</p>

<div class="source"><pre class="prettyprint"><code class="language-java">package examples.simple;

import java.util.List;
import java.util.Optional;

import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Result;
import org.apache.ibatis.annotations.ResultMap;
import org.apache.ibatis.annotations.Results;
import org.apache.ibatis.annotations.SelectProvider;
import org.apache.ibatis.type.JdbcType;
import org.mybatis.dynamic.sql.select.render.SelectStatementProvider;
import org.mybatis.dynamic.sql.util.SqlProviderAdapter;
import org.mybatis.dynamic.sql.util.mybatis3.CommonCountMapper;
import org.mybatis.dynamic.sql.util.mybatis3.CommonDeleteMapper;
import org.mybatis.dynamic.sql.util.mybatis3.CommonInsertMapper;
import org.mybatis.dynamic.sql.util.mybatis3.CommonUpdateMapper;

@Mapper
public interface PersonMapper extends CommonCountMapper, CommonDeleteMapper, CommonInsertMapper&lt;PersonRecord&gt;, CommonUpdateMapper {

    @SelectProvider(type = SqlProviderAdapter.class, method = &quot;select&quot;)
    @Results(id = &quot;PersonResult&quot;, value = {
            @Result(column = &quot;A_ID&quot;, property = &quot;id&quot;, jdbcType = JdbcType.INTEGER, id = true),
            @Result(column = &quot;first_name&quot;, property = &quot;firstName&quot;, jdbcType = JdbcType.VARCHAR),
            @Result(column = &quot;last_name&quot;, property = &quot;lastName&quot;, jdbcType = JdbcType.VARCHAR, typeHandler = LastNameTypeHandler.class),
            @Result(column = &quot;birth_date&quot;, property = &quot;birthDate&quot;, jdbcType = JdbcType.DATE),
            @Result(column = &quot;employed&quot;, property = &quot;employed&quot;, jdbcType = JdbcType.VARCHAR, typeHandler = YesNoTypeHandler.class),
            @Result(column = &quot;occupation&quot;, property = &quot;occupation&quot;, jdbcType = JdbcType.VARCHAR),
            @Result(column = &quot;address_id&quot;, property = &quot;addressId&quot;, jdbcType = JdbcType.INTEGER)
    })
    List&lt;PersonRecord&gt; selectMany(SelectStatementProvider selectStatement);

    @SelectProvider(type = SqlProviderAdapter.class, method = &quot;select&quot;)
    @ResultMap(&quot;PersonResult&quot;)
    Optional&lt;PersonRecord&gt; selectOne(SelectStatementProvider selectStatement);
}
</code></pre></div>
<p>This mapper implements full CRUD functionality for the table. The base interfaces <code>CommonCountMapper</code>,
<code>CommonDeleteMapper</code>, etc. provide insert, update, delete, and count capabilities. Only the select methods must be
written because of the custom result map.</p>
<p>Note that the <code>CommonInsertMapper</code> interface will not properly return the generated key if one is produced by the insert.
If you need generated key support, see the documentation page for INSERT statements for details on how to implement
such support.</p></section><section>
<h2><a name="Executing_SQL_with_MyBatis3"></a>Executing SQL with MyBatis3</h2>
<p>In a service class, you can use the generated statement as input to your mapper methods.  Here are some
examples from <code>examples.simple.PersonMapperTest</code>:</p>

<div class="source"><pre class="prettyprint"><code class="language-java">@Test
void testGeneralSelect() {
    try (SqlSession session = sqlSessionFactory.openSession()) {
        PersonMapper mapper = session.getMapper(PersonMapper.class);

        SelectStatementProvider selectStatement = select(id.as(&quot;A_ID&quot;), firstName, lastName, birthDate, employed,
            occupation, addressId)
        .from(person)
        .where(id, isEqualTo(1))
        .or(occupation, isNull())
        .build()
        .render(RenderingStrategies.MYBATIS3);

        List&lt;PersonRecord&gt; rows = mapper.selectMany(selectStatement);
        assertThat(rows).hasSize(3);
    }
}

@Test
void testGeneralDelete() {
    try (SqlSession session = sqlSessionFactory.openSession()) {
        PersonMapper mapper = session.getMapper(PersonMapper.class);

        DeleteStatementProvider deleteStatement = deleteFrom(person)
        .where(occupation, isNull())
        .build()
        .render(RenderingStrategies.MYBATIS3);

        int rows = mapper.delete(deleteStatement);
        assertThat(rows).isEqualTo(2);
    }
}
</code></pre></div>
<p>If you use MyBatis Generator, the generator will create several additional utility methods in a mapper like this that
will improve its usefulness. You can see a full example of the type of code created by MyBatis generator by looking
at the full example at <a class="externalLink" href="https://github.com/mybatis/mybatis-dynamic-sql/tree/master/src/test/java/examples/simple">https://github.com/mybatis/mybatis-dynamic-sql/tree/master/src/test/java/examples/simple</a></p></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2016&#x2013;2023
<a href="https://www.mybatis.org/">MyBatis.org</a>
</p>
        </div>
      </div>
    </footer>
<script>
	if(anchors) {
	  anchors.add();
	}
</script>
  </body>
</html>
