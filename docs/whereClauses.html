<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from src/site/markdown/docs/whereClauses.md at 06 Jul 2025
 | Rendered using Apache Maven Fluido Skin 2.1.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <title>WHERE Clause Support â€“ MyBatis Dynamic SQL</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-2.1.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-2.1.0.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1><a href="../docs/introduction.html">MyBatis Dynamic SQL</a></h1></div></div>
          <div class="pull-right"><div id="bannerRight"><h1><a href="http://www.mybatis.org/"><img src="https://mybatis.org/images/mybatis-logo.png" alt="MyBatis logo" /> MyBatis</a></h1></div></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 03 Jun 2024<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.0.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">User&apos;s Guide</li>
    <li><a href="../docs/introduction.html">Introduction</a></li>
    <li><a href="../docs/CHANGELOG.html">Change Log</a></li>
    <li><a href="../docs/migratingV1toV2.html">Migrating from V1 to V2</a></li>
    <li><a href="../docs/quickStart.html">Quick Start</a></li>
    <li><a href="../docs/exceptions.html">Exceptions thrown by the Library</a></li>
    <li><a href="../docs/configuration.html">Configuration of the Library</a></li>
    <li><a href="../docs/databaseObjects.html">Modeling Database Objects</a></li>
    <li class="active"><a><span class="icon-chevron-down"></span>WHERE Clause Support</a>
     <ul class="nav nav-list">
      <li><a href="../docs/conditions.html">WHERE Conditions</a></li>
     </ul></li>
    <li><a href="../docs/select.html"><span class="icon-chevron-down"></span>SELECT Statements</a>
     <ul class="nav nav-list">
      <li><a href="../docs/caseExpressions.html">Case Expressions</a></li>
      <li><a href="../docs/complexQueries.html">Complex Queries</a></li>
     </ul></li>
    <li><a href="../docs/delete.html">DELETE Statements</a></li>
    <li><a href="../docs/insert.html">INSERT Statements</a></li>
    <li><a href="../docs/update.html">UPDATE Statements</a></li>
    <li><a href="../docs/subQueries.html">SubQuery Support</a></li>
    <li><a href="../docs/functions.html">Database Functions</a></li>
    <li><a href="../docs/mybatis3.html">MyBatis3 Support</a></li>
    <li><a href="../docs/spring.html">Spring Support</a></li>
    <li><a href="../docs/springBatch.html">Spring Batch Support</a></li>
    <li><a href="../docs/kotlinOverview.html"><span class="icon-chevron-right"></span>Kotlin Support</a></li>
    <li><a href="../docs/howItWorks.html">How it Works</a></li>
    <li><a href="../docs/extending.html">Extending the Library</a></li>
    <li><a href="../docs/codingStandards.html">Coding Standards</a></li>
    <li><a href="../docs/motivation.html">Motivation</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="../project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="../project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section><a id="WHERE_Clause_Support"></a>
<h1>WHERE Clause Support</h1>
<p>This library supports the creation of very flexible WHERE clauses.  WHERE clauses can be added to DELETE, SELECT,
and UPDATE statements.  WHERE clauses can also stand alone for use in other hand coded SQL.</p><section><a id="Simple_WHERE_Clauses"></a>
<h2>Simple WHERE Clauses</h2>
<p>The simplest WHERE clause is of this form:</p>

<pre class="prettyprint"><code class="language-java">        SelectStatementProvider selectStatement = select(count())
                .from(simpleTable)
                .where(id, isEqualTo(3))
                .build()
                .render(RenderingStrategies.MYBATIS3);
</code></pre>
<p>The library ships with a wide variety of conditions that can be used in WHERE clauses including
&#x201c;in&#x201d;, &#x201c;like&#x201d;, &#x201c;between&#x201d;, &#x201c;isNull&#x201d;, &#x201c;isNotNull&#x201d;, and all the normal comparison operators.  For example:</p>

<pre class="prettyprint"><code class="language-java">        SelectStatementProvider selectStatement = select(count())
                .from(simpleTable)
                .where(id, isBetween(3).and(6))
                .build()
                .render(RenderingStrategies.MYBATIS3);
</code></pre>

<pre class="prettyprint"><code class="language-java">        SelectStatementProvider selectStatement = select(count())
                .from(simpleTable)
                .where(id, isIn(3,4,5))
                .build()
                .render(RenderingStrategies.MYBATIS3);
</code></pre>

<pre class="prettyprint"><code class="language-java">        SelectStatementProvider selectStatement = select(count())
                .from(simpleTable)
                .where(id, isNotNull())
                .build()
                .render(RenderingStrategies.MYBATIS3);
</code></pre></section><section><a id="Complex_WHERE_Clauses"></a>
<h2>Complex WHERE Clauses</h2>
<p>Conditions can be &#x201c;anded&#x201d; and &#x201c;ored&#x201d; in virtually any combination. For example:</p>

<pre class="prettyprint"><code class="language-java">        SelectStatementProvider selectStatement = select(count())
                .from(simpleTable, &quot;a&quot;)
                .where(id, isGreaterThan(2))
                .or(occupation, isNull(), and(id, isLessThan(6)))
                .build()
                .render(RenderingStrategies.MYBATIS3);
</code></pre></section><section><a id="Subqueries"></a>
<h2>Subqueries</h2>
<p>Most of the conditions also support a subquery.  For example:</p>

<pre class="prettyprint"><code class="language-java">        SelectStatementProvider selectStatement = select(column1.as(&quot;A_COLUMN1&quot;), column2)
                .from(table, &quot;a&quot;)
                .where(column2, isIn(select(column2).from(table).where(column2, isEqualTo(3))))
                .or(column1, isLessThan(d))
                .build()
                .render(RenderingStrategies.MYBATIS3);
</code></pre></section><section><a id="Stand_Alone_Where_Clauses"></a>
<h2>Stand Alone Where Clauses</h2>
<p>Although rare, you can use the where clause support on its own if you would rather code your own SQL for the remainder
of a statement. There may be several reasons to do this - mainly if the library doesn't support some SQL or MyBatis
feature you want to use. A good example would be if you want to append other SQL to the generated SQL produced by the
library. If you want to use a stand alone where clause, you can code a mapper method that looks like this:</p>

<pre class="prettyprint"><code class="language-java">    @Select({
        &quot;select id, animal_name, brain_weight, body_weight&quot;,
        &quot;from AnimalData&quot;,
        &quot;${whereClause}&quot;
    })
    @ResultMap(&quot;AnimalDataResult&quot;)
    List&lt;AnimalData&gt; selectWithWhereClause(WhereClauseProvider whereClause);
</code></pre>
<p>You can build a stand alone where clause and call your mapper like this:</p>

<pre class="prettyprint"><code class="language-java">    Optional&lt;WhereClauseProvider&gt; whereClause = where(id, isNotBetween(10).and(60))
            .build()
            .render(RenderingStrategies.MYBATIS3);

    List&lt;AnimalData&gt; animals = whereClause.map(wc -&gt; mapper.selectWithWhereClause(wc)).orElse(Collections.emptyList());
</code></pre>
<p>This method works well when there are no other parameters needed for the statement and when there are no table aliases
involved.  If you have those other needs, then see the following.</p><section><a id="Table_Aliases"></a>
<h3>Table Aliases</h3>
<p>If you need to use a table alias in the generated where clause you can supply it on the render method using the
<code>TableAliasCalculator</code> class.  For example, if you have a mapper like this:</p>

<pre class="prettyprint"><code class="language-java">    @Select({
        &quot;select a.id, a.animal_name, a.brain_weight, a.body_weight&quot;,
        &quot;from AnimalData a&quot;,
        &quot;${whereClause}&quot;
    })
    @ResultMap(&quot;AnimalDataResult&quot;)
    List&lt;AnimalData&gt; selectWithWhereClauseAndAlias(WhereClauseProvider whereClause);
</code></pre>
<p>Then you can specify the alias for the generated WHERE clause on the render method like this:</p>

<pre class="prettyprint"><code class="language-java">    Optional&lt;WhereClauseProvider&gt; whereClause = where(id, isEqualTo(1), or(bodyWeight, isGreaterThan(1.0)))
            .build()
            .render(RenderingStrategies.MYBATIS3, TableAliasCalculator.of(animalData, &quot;a&quot;));

    List&lt;AnimalData&gt; animals = whereClause.map(wc -&gt; mapper.selectWithWhereClauseAndAlias(wc)).orElse(Collections.emptyList());
</code></pre>
<p>It is more likely that you will be using table aliases with hand coded joins where there is more than on table alias.
In this case, you supply a <code>Map&lt;SqlTable, String&gt;</code> to the TableAliasCalculator that holds an alias for each table
involved in the WHERE clause.</p></section><section><a id="Handling_Multiple_Parameters"></a>
<h3>Handling Multiple Parameters</h3>
<p>By default, the WHERE clause renderer assumes that the rendered WHERE clause will be the only parameter to the mapper
method. This is not always the case. For example, suppose you have a paginated query like this (this is HSQLDB syntax):</p>

<pre class="prettyprint"><code class="language-java">    @Select({
        &quot;select id, animal_name, brain_weight, body_weight&quot;,
        &quot;from AnimalData&quot;,
        &quot;${whereClauseProvider.whereClause}&quot;,
        &quot;order by id&quot;,
        &quot;OFFSET #{offset,jdbcType=INTEGER} LIMIT #{limit,jdbcType=INTEGER}&quot;
    })
    @ResultMap(&quot;AnimalDataResult&quot;)
    List&lt;AnimalData&gt; selectWithWhereClauseLimitAndOffset(@Param(&quot;whereClauseProvider&quot;) WhereClauseProvider whereClause,
            @Param(&quot;limit&quot;) int limit, @Param(&quot;offset&quot;) int offset);
</code></pre>
<p>In this mapper method there are three parameters.  So in this case it will be necessary to tell the WHERE rendered what
parameter name to use the for rendered where clause.  That code looks like this:</p>

<pre class="prettyprint"><code class="language-java">    Optional&lt;WhereClauseProvider&gt; whereClause = where(id, isLessThan(60))
            .build()
            .render(RenderingStrategies.MYBATIS3, &quot;whereClauseProvider&quot;);

    List&lt;AnimalData&gt; animals = whereClause.map(wc -&gt; mapper.selectWithWhereClauseLimitAndOffset(wc, 5, 15)).orElse(Collections.emptyList());
</code></pre>
<p>Notice that the string <code>whereClauseProvider</code> is used both as the parameter name in the mapper <code>@Param</code> annotation,
and the parameter name in the <code>render</code> method.</p>
<p>The render method also has an override that accepts a <code>TableAliasCalculator</code> and a parameter name.</p></section></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Â©      2016â€“2025
<a href="https://www.mybatis.org/">MyBatis.org</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
